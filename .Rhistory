a
a <- data.frame(DEPs)
b <- data.frame(DEPs)
c <- data.frame(a,b)
View(circ.DEPs)
c <- []
c <- ""
a <- data.frame(DEPs)
b <- data.frame(DEPs)
c$a <- a
c$b <- b
a
c
c$a
c$b
c
mode(c)
View(c)
View(GO.result)
View(c)
cutoff=0.05
EnrichR_for_GOplot <- function(DEPs,GOdb, cutoff){
if(missing(cutoff)){
cutoff = 0.05
}
GO.result <- DEPs2EncirhR(DEPs, GOdb)
GO.result$GO_Biological_Process_2023$Category <- "BP"
GO.result$GO_Cellular_Component_2023$Category <- "CC"
GO.result$GO_Molecular_Function_2023$Category <- "MF"
GO.result$KEGG_2021_Human$Category <- "KEGG"
GO.result.all <- rbind(
GO.result$GO_Biological_Process_2023 ,
GO.result$GO_Cellular_Component_2023,
GO.result$GO_Molecular_Function_2023
)
KEGG.result <- GO.result$KEGG_2021_Human
KEGG.result$ID <- "KEGG"
export.EnrichR$GO.result.all <- GO.result.all
export.EnrichR$KEGG.result <- KEGG.result
return(export.EnrichR)
}
test <- EnrichR_for_GOplot(DEPs,GOdb)
cutoff=0.05
EnrichR_for_GOplot <- function(DEPs,GOdb, cutoff){
if(missing(cutoff)){
cutoff = 0.05
}
GO.result <- DEPs2EncirhR(DEPs, GOdb)
GO.result$GO_Biological_Process_2023$Category <- "BP"
GO.result$GO_Cellular_Component_2023$Category <- "CC"
GO.result$GO_Molecular_Function_2023$Category <- "MF"
GO.result$KEGG_2021_Human$Category <- "KEGG"
GO.result.all <- rbind(
GO.result$GO_Biological_Process_2023 ,
GO.result$GO_Cellular_Component_2023,
GO.result$GO_Molecular_Function_2023
)
KEGG.result <- GO.result$KEGG_2021_Human
KEGG.result$ID <- "KEGG"
export.EnrichR <- ""
export.EnrichR$GO.result.all <- GO.result.all
export.EnrichR$KEGG.result <- KEGG.result
return(export.EnrichR)
}
test <- EnrichR_for_GOplot(DEPs,GOdb)
a <- data.frame(DEPs)
b <- data.frame(DEPs)
c$a <- a
c$b <- b
c
c$a
View(circ.DEPs)
mode(GO.result)
mode(GO.result.all)
GO.result.all
GO.result.all
mode(GO.result.all)
mode(a)
cutoff=0.05
EnrichR_for_GOplot <- function(DEPs,GOdb, cutoff){
if(missing(cutoff)){
cutoff = 0.05
}
GO.result <- DEPs2EncirhR(DEPs, GOdb)
GO.result$GO_Biological_Process_2023$Category <- "BP"
GO.result$GO_Cellular_Component_2023$Category <- "CC"
GO.result$GO_Molecular_Function_2023$Category <- "MF"
GO.result$KEGG_2021_Human$Category <- "KEGG"
GO.result.all <- rbind(
GO.result$GO_Biological_Process_2023 ,
GO.result$GO_Cellular_Component_2023,
GO.result$GO_Molecular_Function_2023
)
KEGG.result <- GO.result$KEGG_2021_Human
KEGG.result$ID <- "KEGG"
export.EnrichR <- list(GO.result.all, KEGG.result)
return(export.EnrichR)
}
test <- EnrichR_for_GOplot(DEPs,GOdb)
test
cutoff=0.05
EnrichR_for_GOplot <- function(DEPs,GOdb, cutoff){
if(missing(cutoff)){
cutoff = 0.05
}
GO.result <- DEPs2EncirhR(DEPs, GOdb)
GO.result$GO_Biological_Process_2023$Category <- "BP"
GO.result$GO_Cellular_Component_2023$Category <- "CC"
GO.result$GO_Molecular_Function_2023$Category <- "MF"
GO.result$KEGG_2021_Human$Category <- "KEGG"
GO.result.all <- rbind(
GO.result$GO_Biological_Process_2023 ,
GO.result$GO_Cellular_Component_2023,
GO.result$GO_Molecular_Function_2023
)
KEGG.result <- GO.result$KEGG_2021_Human
KEGG.result$ID <- "KEGG"
export.EnrichR <- list(GO.result.all=GO.result.all, KEGG.result=KEGG.result)
return(export.EnrichR)
}
test
View(test)
View(test)
View(GO.result)
View(test)
cutoff=0.05
EnrichR_for_GOplot <- function(DEPs,GOdb, cutoff){
if(missing(cutoff)){
cutoff = 0.05
}
GO.result <- DEPs2EncirhR(DEPs, GOdb)
GO.result$GO_Biological_Process_2023$Category <- "BP"
GO.result$GO_Cellular_Component_2023$Category <- "CC"
GO.result$GO_Molecular_Function_2023$Category <- "MF"
GO.result$KEGG_2021_Human$Category <- "KEGG"
GO.result.all <- rbind(
GO.result$GO_Biological_Process_2023 ,
GO.result$GO_Cellular_Component_2023,
GO.result$GO_Molecular_Function_2023
)
KEGG.result <- GO.result$KEGG_2021_Human
KEGG.result$ID <- "KEGG"
export.EnrichR <- list(GO=GO.result.all, KEGG=KEGG.result)
return(export.EnrichR)
}
test <- EnrichR_for_GOplot(DEPs,GOdb)
test$GO
devtools::load_all()
devtools::load_all()
test <- EnrichR2GOplot(DEPs,GOdb)
test
View(test)
GOplot::GOCircle(test)
devtools::load_all()
test <- EnrichR2GOplot(DEPs,GOdb)
test
GOplot::GOCircle(test)
result <- Merge_enrichR_forGOplot(DEPs, GOdb)
result$GO
use_r(export_table_EnrichR2GOplot)
use_r("export_table_EnrichR2GOplot")
Merge_enrichR_export <- Merge_enrichR_forGOplot(DEPs,GOdb,cutoff)
Merge_enrichR_export$GO
Merge_enrichR_export$test <- test
Merge_enrichR_export
Merge_enrichR_export$test
devtools::load_all()
test <- EnrichR2GOplot(DEPs, GOdb)
test$GO
test$KEGG
test$circ
test$GO
test$GO %>% colnames
DEPs
test$GO %>% colnames
export_from_EncirhR2GOplot <- test
GO.export <- export_from_EncirhR2GOplot$GO %>% subset(select=c("Category","ID","Term","Adjusted.P.value","Genes"))
GO.export <- export_from_EncirhR2GOplot$GO %>% subset(select=c("Category","ID","Term","Adjusted.P.value","Genes"))
head(export_from_EncirhR2GOplot$GO)
colnames(export_from_EncirhR2GOplot$GO)
devtools::load_all()
test <- EnrichR2GOplot(DEPs, GOdb)
test$EnrichR.GO
test$EnrichR.KEGG
test$circ
export_from_EncirhR2GOplot <- test
colnames(export_from_EncirhR2GOplot$EnrichR.GO)
EnrichR.GO <- export_from_EncirhR2GOplot$EnrichR.GO)
EnrichR.GO <- export_from_EncirhR2GOplot$EnrichR.GO
EnrichR.GO <- export_from_EncirhR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
colnames(EnrichR.GO.parse) <- c("Category","ID","term","Overlap","adj_pval","Odds.Ratio","Combined.Score","Genes")
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
EnrichR.GO.parse
View(EnrichR.GO.parse)
circ_result
circ_result <- export_from_EncirhR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
circ_result
View(circ_result)
EnrichR.GO <- export_from_EncirhR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
circ_result <- export_from_EncirhR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_from_EncirhR2GOplot$EnrichR.KEGG
head(export_from_EncirhR2GOplot$EnrichR.KEGG)
GOplot::circle_dat(export_from_EncirhR2GOplot$EnrichR.KEGG, DEPs)
test <- GOplot::circle_dat(export_from_EncirhR2GOplot$EnrichR.KEGG, DEPs)
xport_from_EncirhR2GOplot$EnrichR.KEGG
export_from_EncirhR2GOplot$EnrichR.KEGGa
xport_from_EncirhR2GOplot$EnrichR.KEGG
export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <- %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.circ.result <- circle_dat(KEGG.parse_forGOplot,log2FC)
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,log2FC)
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs)
KEGG.parse_forGOplot
head(KEGG.parse_forGOplot)
GOplot::circle_dat(KEGG.parse_forGOplot,DEPs)
View(circ_result)
View(test)
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs)
KEGG.parse_forGOplot
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs)
head(DEPs)
export_table_EnrichR2GOplot <- function(export_from_EncirhR2GOplot , DEPs){
EnrichR.GO <- export_from_EncirhR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
circ_result <- export_from_EncirhR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
"""
KEGG processing
"""
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
DEPs_forKEGG <- DEPs %>% subset(select=c("GeneName","logFC"))
colnames(DEPs_forKEGG) <- c("ID","logFC")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs_forKEGG)
KEGG.circ.result
KEGG.result <- export_from_EncirhR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
DEPs_forKEGG <- DEPs %>% subset(select=c("GeneName","logFC"))
colnames(DEPs_forKEGG) <- c("ID","logFC")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs_forKEGG)
KEGG.circ.result <- KEGG.circ.result %>% select(c("term","zscore")) %>% unique
colnames(KEGG.circ.result) <- c("Term","Zscore")
export_KEGGTable <- dplyr::left_join(KEGG.parse,  KEGG.circ.result , by="Term")
export_KEGGTable
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
export_from_EnrichR2GOplot <- export_from_EncirhR2GOplot
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
circ_result <- export_from_EnrichR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
"""
KEGG processing
"""
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
circ_result <- export_from_EnrichR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
KEGG.result <- export_from_EnrichR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
DEPs_forKEGG <- DEPs %>% subset(select=c("GeneName","logFC"))
colnames(DEPs_forKEGG) <- c("ID","logFC")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs_forKEGG)
KEGG.circ.result <- KEGG.circ.result %>% select(c("term","zscore")) %>% unique
colnames(KEGG.circ.result) <- c("Term","Zscore")
export_KEGGTable <- dplyr::left_join(KEGG.parse,  KEGG.circ.result , by="Term")
export <- list( Export.EnrichR2GOplot.GO = export_GOTable, Export.EnrichR2GOplot.KEGG = export_KEGGTable  )
export
export$Export.EnrichR2GOplot.GO
export$Export.EnrichR2GOplot.GO
export$Export.EnrichR2GOplot.KEGG
export$Export.EnrichR2GOplot.GO
EnrichR.GO
EnrichR.GO %>% subset(Adjusted.P.value > 0.05)
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
EnrichR.GO.parse %>% subset(Adjusted.P.value <= 0.05)
circ_result <- export_from_EnrichR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
KEGG.result <- export_from_EnrichR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
DEPs_forKEGG <- DEPs %>% subset(select=c("GeneName","logFC"))
colnames(DEPs_forKEGG) <- c("ID","logFC")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs_forKEGG)
KEGG.circ.result <- KEGG.circ.result %>% select(c("term","zscore")) %>% unique
colnames(KEGG.circ.result) <- c("Term","Zscore")
export_KEGGTable <- dplyr::left_join(KEGG.parse,  KEGG.circ.result , by="Term")
export <- list( Export.EnrichR2GOplot.GO = export_GOTable, Export.EnrichR2GOplot.KEGG = export_KEGGTable  )
EnrichR.GO %>% subset(Adjusted.P.value > 0.05)
export
export$Export.EnrichR2GOplot.GO
test <- export$Export.EnrichR2GOplot.GO
circ_result
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
EnrichR.GO.parse <- EnrichR.GO.parse %>% subset(Adjusted.P.value <= 0.05)
circ_result <- export_from_EnrichR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
test <- export$Export.EnrichR2GOplot.GO
view(test)
View(test)
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
EnrichR.GO.parse <- EnrichR.GO.parse %>% subset(Adjusted.P.value <= 0.05)
circ_result <- export_from_EnrichR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
export_GOTable
nrow(export_GOTable)
nrow(EnrichR.GO.parse)
nrow(circ_result)
EnrichR.GO <- export_from_EnrichR2GOplot$EnrichR.GO
GOID.list <- EnrichR.GO$Term %>% stringr::str_split("\\(GO:")
terms <- GOID.list %>% sapply(`[`,1)
termIDs <- GOID.list %>% sapply(`[`,2) %>% gsub("\\)","", .) %>% paste0("GO:",.)
EnrichR.GO$Term <- terms
EnrichR.GO$ID <- termIDs
EnrichR.GO.parse <- EnrichR.GO %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
EnrichR.GO.parse$Genes<- gsub(";",",",EnrichR.GO.parse$Genes)
EnrichR.GO.parse <- EnrichR.GO.parse %>% subset(Adjusted.P.value <= 0.05)
circ_result <- export_from_EnrichR2GOplot$circ %>% dplyr::select(c("term","zscore")) %>% unique()
colnames(circ_result) <- c("Term","Z.score")
export_GOTable <- dplyr::left_join(EnrichR.GO.parse,  circ_result , by="Term")
KEGG.result <- export_from_EnrichR2GOplot$EnrichR.KEGG
KEGG.parse <-KEGG.result %>% subset(.,select=c("Category","ID","Term","Overlap","Adjusted.P.value","Odds.Ratio","Combined.Score","Genes"))
KEGG.parse$Genes<- gsub(";",",",KEGG.parse$Genes)
KEGG.parse_forGOplot <- KEGG.parse %>% subset(., select=c("Category","ID","Term","Adjusted.P.value","Genes"))
colnames(KEGG.parse_forGOplot) <- c("Category","ID","Term","adj_pval","Genes")
DEPs_forKEGG <- DEPs %>% subset(select=c("GeneName","logFC"))
colnames(DEPs_forKEGG) <- c("ID","logFC")
KEGG.circ.result <- GOplot::circle_dat(KEGG.parse_forGOplot,DEPs_forKEGG)
KEGG.circ.result <- KEGG.circ.result %>% select(c("term","zscore")) %>% unique
colnames(KEGG.circ.result) <- c("Term","Zscore")
export_KEGGTable <- dplyr::left_join(KEGG.parse,  KEGG.circ.result , by="Term")
export <- list( Export.EnrichR2GOplot.GO = export_GOTable, Export.EnrichR2GOplot.KEGG = export_KEGGTable  )
export$Export.EnrichR2GOplot.GO %>% nrow
devtools::load_all()
test <- EnrichR2GOplot(DEPs, GOdb)
export.test <- export_table_EnrichR2GOplot(test)
export.test <- export_table_EnrichR2GOplot(test, DEPs)
export.test$Export.EnrichR2GOplot.GO
use_mit_license()
usethat::use_vignette("introduction")
devtools::use_vignette("introduction")
use_vignette(("introduction"))
devtools::document("./R")
devtools::document("./R")
devtools::document("./R")
devtools::document("./R")
devtools::document("./R")
devtools::document("./R")
devtools::document("./R")
devtools::load_all()
data(DEPs)
DEPs
View(export.test)
data(DEPs)
data(DEPs)
head(DEPs)
data(GOdb)
GOdb
data(DEPs)
head(DEPs)
data(GOdb)
print(GOdb)
```{r setup}
data(GOdb)
print(GOdb)
data(DEPs)
head(DEPs)
GO.result <- EnrichR2GOplot(DEPs, GOdb,cutoff)
GO.result
head(GO.result)
View(GO.result)
export <- export_table_EnrichR2GOplot(GO.result, DEPs, 0.05)
export
export
export$Export.EnrichR2GOplot.GO
export$Export.EnrichR2GOplot.KEGG
#library(EnrichR2GOplot)
library(GOplot)
devtools::load_all()
library(openxlsx)
install.packages('openxlsx')
library(openxlsx)
output_xlsx <- createWorkbook()
DEPs
Genes <- DEPs$GeneName
Genes
Genes %>% head
data.frame(Genes)
data.frame(Genes) %>% head
data.frame(GeneName = Genes) %>% head
data.frame(GeneName = DEPs$GeneName) %>% head
data(DEPs)
Genes <- data.frame(GeneName = DEPs$GeneName)
result.DEPs2EncirhR <- DEPs2EncirhR(Genes, GOdb)
DEPs2EncirhR
result.DEPs2EncirhR
result.DEPs2EncirhR <- DEPs2EncirhR(Genes, Select_DB)
Select_DB <- c("GO_Molecular_Function_2015","GO_Cellular_Component_2015","GO_Cellular_Component_2015")
result.DEPs2EncirhR <- DEPs2EncirhR(Genes, Select_DB)
result.DEPs2EncirhR
result.DEPs2EncirhR[1]
data.frame(result.DEPs2EncirhR[1])
devtools::install_github("seongminlab/EnrichR2GOplot")
devtools::install_github("seongminlab/EnrichR2GOplot")
library("EnrichR2GOplot")
EnrichR2GOplot::DEPs2EncirhR()
EnrichR2GOplot::DEPs2EncirhR(DEPs,GOdb, 0.05)
EnrichR2GOplot::DEPs2EncirhR(DEPs,GOdb)
if (!require("devtools", quietly = TRUE))
install.packages("devtools")
if (!require("tidyverse", quietly = TRUE))
install.packages("tidyverse")
if (!require("GOplot", quietly = TRUE))
install.packages("GOplot")
if (!require("enrichR", quietly = TRUE))
install.packages("enrichR")
devtools::install_github("seongminlab/EnrichR2GOplot")
